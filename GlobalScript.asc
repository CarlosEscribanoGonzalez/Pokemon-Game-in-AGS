// main global script file

// called when the game starts, before the first room is loaded
function game_start()
{
}

// called on every game cycle, except when the game is blocked
function repeatedly_execute()
{
}

// called on every game cycle, even when the game is blocked
function repeatedly_execute_always()
{
}

// called when a key is pressed
function on_key_press(eKeyCode keycode)
{
  if (IsGamePaused())
  {
    // game paused, so don't react to any keypresses
    keycode = 0;
  }
  else if (keycode == eKeyCtrlQ)
  {
    // Ctrl-Q will quit the game
    QuitGame(1);
  }
  else if (keycode == eKeyF9)
  {
    // F9 will restart the game
    RestartGame();
  }
  else if (keycode == eKeyF12)
  {
    // F12 will save a screenshot to the save game folder
    SaveScreenShot("screenshot.pcx");
  }
  else if (keycode == eKeyCtrlS)
  {
    // Ctrl-S will give the player all defined inventory items
    Debug(0, 0);
  }
  else if (keycode == eKeyCtrlV)
  {
    // Ctrl-V will show game engine version and build date
    Debug(1, 0);
  }
  else if (keycode == eKeyCtrlA)
  {
    // Ctrl-A will show walkable areas
    Debug(2, 0);
  }
  else if (keycode == eKeyCtrlX)
  {
    // Ctrl-X will let the player teleport to any room
    Debug(3, 0);
  }
}

// called when a mouse button is clicked
function on_mouse_click(MouseButton button)
{
  if (IsGamePaused())
  {
    // game is paused, so do nothing (i.e. don't process mouse clicks)
  }
  else if (button == eMouseLeft)
  {
    // left-click, so try using the current mouse cursor mode at this position
    Room.ProcessClick(mouse.x, mouse.y, mouse.Mode);
  }
  else if (button == eMouseRight)
  {
    // right-click, so cycle the mouse cursor mode
    mouse.SelectNextMode();
  }
}

//GUI
function dialog_request(int param) {
}
function gMenu_OnClick(GUI *theGui, MouseButton button)
{

}

function Button1_OnClick(GUIControl *control, MouseButton button)
{
mouse.Mode = eModeTalkto;
}

function Button2_OnClick(GUIControl *control, MouseButton button)
{
mouse.Mode = eModeInteract;
}

function Button3_OnClick(GUIControl *control, MouseButton button)
{
mouse.Mode = eModeWalkto;
}


// PUEBLO AMBAR

function cSacerdotisa_Talk()
{
 cProtag.Walk(834, 272, eBlock, eWalkableAreas);
 if (puzzle2 == true) {
   cSacerdotisa.Say("¡Eso es! 20 de marzo de 1997, el día más feliz de mi vida.");
   cSacerdotisa.Say("Muchas gracias por ayudarme, jovenzuelo. Si hay algo que pueda hacer por ti, dímelo. ¿Estás indagando sobre la desaparición?");
   cSacerdotisa.Say("Las cámaras de la sala de control fueron desactivadas, ¡ pero solo el líder de gimnasio y el alcalde tienen acceso!. No se sabe dónde se fue. Buscamos en sus lugares preferidos, el acantilado,y el laboratorio, pero yo no pude encontrar nada, quizá deberías probar suerte.");
 }
  else if (policia == true) {
  dDialog1.Start();
  }
  else {
    cSacerdotisa.Say("¡Déjame, por favor! Madre mía qué disgusto más grande...");
  }
}

function cSegurata_Talk()
{
 cProtag.Walk(308, 404, eBlock, eWalkableAreas);
 cProtag.FaceCharacter(cSegurata);
 if (conchi == true) {
   if (ZonaCrimen == false) {
    cSegurata.Say("¿Has encontrado al Skitty de mi tía? ¡Muchas gracias por ayudarla! Parece que se te da bien encontrar pokémon perdidos. Quizá no vendría mal que echaras un vistazo dentro.");
    ZonaCrimen=true;
    RestoreWalkableArea(2);
   }
   cSegurata.Say("No puedo esperar para llegar a casa y ver a Skitty.");
 }
 else{
   cSegurata.Say("No puedes pasar, están investigando ahí dentro.");
 }
}

function cConchi_Talk()
{
 cProtag.Walk(545, 405, eBlock, eWalkableAreas);
 cProtag.FaceCharacter(cConchi);
 if (puzzle1 == false) {
   dDialog6.Start();
 }
 else {
   cConchi.Say("¿Cómo? ¿Que mi bebé está en el árbol? ¡Muchísimas gracias por encontrarlo! Si pudieras avisar a mi sobrino de que ya sé dónde está, me harías un gran favor. Es el segurata que está en la fábrica.");
   cConchi.Transparency=100;
   cConchi.Clickable = false;
   cAmiga.Transparency=100;
   cAmiga.Clickable = false;
   cSkitty.Transparency=100;
   cSkitty.Clickable = false;
   conchi=true;
 }
}

function cSkitty_Interact()
{
  cProtag.Walk(786, 269, eBlock, eWalkableAreas);
  cProtag.FaceCharacter(cSkitty);
  aGrito_de_Skitty.Play();
  cProtag.Say("Está demasiado lejos como para que pueda llegar. Avisaré a su dueña para que venga ella.");
  puzzle1 = true;
}

function cPokemonista_Talk()
{
  cProtag.Walk(583, 275, eBlock, eWalkableAreas);
  cProtag.FaceCharacter(cPokemonista);
  cPokemonista.Say("No me extrañaría que el Electabuzz se hubiera escapado él solito. Sólo hay que ver el estado en el que lo mantenían encerrado. Y luego la sacerdotisa, que de santa y vírgen tiene poco, lo pasea por el pueblo como si no pasara nada.");
  cPokemonista.Say("¡DE NORTE A SUR!¡DE ESTE A OESTE! ¡LA LUCHA SIGUE CUESTE LO QUE CUESTE! NO PERMITIREMOS EL ABUSO POKÉMON.");
}

function cConspi_Talk()
{
  cProtag.Walk(562, 320, eBlock, eWalkableAreas);
  cProtag.FaceCharacter(cConspi);
  cConspi.Say("Seguro que fue el líder del gimnasio, Carrero, quien robó nuestro Electabuzz. Ese miedica haría cualquier cosa por ganar, hasta incapacitar nuestros pokémon eléctricos para dar ventaja a sus voladores.");
  cConspi.Say("Ver a esa niñata fanática me pone enferma. ¿Cómo puede tener fans alguien tan inúti?");
}

function cFan_Talk()
{
 cProtag.Walk(730, 416, eBlock, eWalkableAreas);
 cProtag.FaceCharacter(cFan);
 cFan.Say("¿Estás buscando al líder? Me temo que hasta que no resolvamos nuestro problema no te va a conceder un combate.");
 cFan.Say("Desafortunadamente no volverá la luz hasta que encontremos al pokémon desaparecido, pues es la única fuente de electricidad del pueblo.");
}

function cAceitunas_Talk()
{
 cProtag.Walk(664, 455, eBlock, eWalkableAreas);
 cProtag.FaceCharacter(cAceitunas);
 cAceitunas.Say("¡Pardiez! Me he pasao de sol a sol recogiendo aceitunah pa que venga un malnacido a comérselah.");
 cAceitunas.Say("Vi la sombra yéndose hacia el norte, como lo encuentre va pa la cazuela...");
}

function cEnfermera_Talk()
{
 cProtag.Walk(344, 540, eBlock, eWalkableAreas);
 cProtag.FaceCharacter(cEnfermera);
  if (policia == true) {
  cEnfermera.Say("Estos jóvenes de hoy en día, con esas fiestas innecesarias...");
  cEnfermera.Say("La única que merece realmente la pena es la que aquí llamamos Ostara, durante el equinoccio. Siempre es bien recibida por el pueblo, sobre todo el Ostara en el que adoptamos a Electabuzz.");
  }
  else {
    cEnfermera.Say("No sabes qué cantidad de jóvenes están llegando al hospital últimamente. No hay iluminación por las noches y, aun así, se van de fiesta. Claro, luego pasa lo que pasa...");
    cEnfermera.Say("Es la misma historia que con el COVID. Espera... ¿Qué es el COVID? Debo haberlo inventado...");
  }
}


function cTrabaj_Talk()
{
 cProtag.Walk(860, 575, eBlock, eWalkableAreas);
 cProtag.FaceCharacter(cTrabaj);
 if (policia == true) {
   cTrabaj.Say("Aunque mi trabajo sea duro, a veces también me sorprende con unas vistas espectaculares. Ver el campo floreciendo me aporta un sentimiento de paz similar al que siento cuando mi mujer por fin decide callarse.");
   cTrabaj.Say("Sin embargo, nunca he visto el floreciente campo tan bonito como cuando llegó Electabuzz al pueblo. Fue como si incluso la Madre Naturaleza lo estuviera recibiendo.");
 }
 else {
   cTrabaj.Say("Estoy preocupado por la falta de luz. Tengo una familia que mantener y no doy a basto con tanto trabajo. Estamos subsistiendo gracias a la ayuda de mi Electrike, pero no creo que aguante mucho más, esta situación me supera... Pero no pienses nada raro eh.");
 }
}

function cPesca_Talk()
{
 cProtag.Walk(847, 677, eBlock, eWalkableAreas);
 cProtag.FaceCharacter(cPesca);
 if (policia == true) {
   cPesca.Say("Vamos... A la séptima va la vencida, o eso dicen. Aquí se dice que el 7 es el número de la suerte... ¡para algo fue el año en el que llegó Electabuzz!");
 }
 else {
   cPesca.Say("Sólo hay Magikarps... ¡Son más inútiles que un cani en una biblioteca!");
 }
}

function cEmpren_Talk()
{
 cProtag.Walk(1039, 506, eBlock, eWalkableAreas);
 cProtag.FaceCharacter(cEmpren);
 if (policia == true) {
   if (pistaEmpre == false) {
     cEmpren.Say("Ya casi puedo oler el dulce aroma del dinero. Nunca he estado tan cerca de mi objetivo desde que llegué al pueblo en la década de los 90.");
     pistaEmpre = true;
   }
   cEmpren.Say("Tantas promesas de avance y prosperidad por la reciente llegada de tan formidable Electabuzz me hicieron venir aquí a probar suerte.");
 }
 else {
   cEmpren.Say("El dinero, chico, el dinero mueve el mundo. Con mi innovadora idea de negocio llegaré a ser un hombre exitoso. Aunque, me temo que tendré que esperar hasta que vuelva la electricidad. ¿Que cuál es mi idea? ¡Nunca permitiré que robes mi propiedad intelectual!");
 }
}
// Objetivo: Hablar con el lider del gimnasio
function cCientifico_Talk()
{
 cProtag.Walk(293, 720, eBlock, eWalkableAreas);
 cProtag.FaceCharacter(cCientifico);
 if (pistaEmpre == true) {
   cCientifico.Say("Estoy cerca de encontrar una nueva forma de conseguir electricidad sin necesidad de usar pokémon. Obviamente, la calidad no será la misma, pero por algo se empieza. Aun así, espero que Electabuzz esté bien...");
  }
 else {
   cCientifico.Say("Las recientes investigaciones prometen. Estoy a punto de lograr algo grande, chico. Aunque ya lo habría logrado si el ayuntamiento me hubiera ayudado en vez de haberse gastado el dinero en propuestas inútiles.");
 }
}

function cEntrenador_Talk()
{
 cProtag.Walk(1151, 174, eBlock, eWalkableAreas);
 cProtag.FaceCharacter(cEntrenador);
 if (pistaEmpre == true) {
   cEntrenador.Say("¿Vienes también a culparme, al igual que tantos en el pueblo? Pues déjame decirte que yo no tengo nada que ver.");
   cEntrenador.Say("¿Entonces la sacerdotisa te dijo que únicamente podíamos ser el alcalde o yo? Con que no hay grabaciones de seguridad, ya veo...");
   cEntrenador.Say("Algo me dice que el alcalde está metido en todo esto. No me extrañaría, al fin y al cabo es un sucio caciquista canovista. Aunque no tengo muy claro qué significa eso último.");
   cEntrenador.Say("Una mala racha de combates hizo que el alcalde dejara de confiar en mí. Incluso cambió el código de acceso a la sala de control, desde donde se pueden abrir las puertas. Si fuera tú, no dudaría en ir a hablar con él.");
   boss = true;
   int contador1 = 0;
 }
 else {
   cEntrenador.Say("¿Quieres un combate? Lo siento amigo, hasta que no recuperemos la luz no voy a entrar.");
   cEntrenador.Say("Sólo con imaginar estar ahí dentro a oscuras... ¡Basta de cuartos oscuros!");
   
 }
}

function cPuertas_Interact()
{
 cProtag.Walk(583, 268, eBlock, eWalkableAreas);
 cProtag.FaceCharacter(cPuertas);
 if (boss == true) {
    cPuertas.Say("(Desde el interior de su despacho)¿Que te manda el líder del gimnasio? Está bien, puedes pasar.");
    RestoreWalkableArea(3);
    cProtag.Say("¿Tengo todo lo necesario para entrar? He de asegurarme de tener toda la información posible.");
 }
 else if(boss==false){
   cPuertas.Say("No puedes pasar ahora, el alcalde está ocupado.");
 }
}


//Escena del crimen

function cCop_Talk()
{
 cProtag.Walk(341, 405, eBlock, eWalkableAreas);
 cProtag.FaceCharacter(cCop);
 cCop.Say("Estás aquí para ayudar, ¿no? Bueno, si el segurata ha confiado en ti, yo también lo haré. Realmente no tenemos muchas pistas del paradero del pokémon.");
 cCop.Say("No parece que haya signos de violencia, por lo que los ladrones debieron haberlo robado durante el cambio de puesto de seguridad, sobre las 4 AM.");
 cCop.Say("Además, la cerradura no está forzada, por lo que alguien debió dejarles entrar. Lo único que podemos investigar ahora es si alguien del pueblo colaboró con ellos.");
 cCop.Say("Tenemos un par de sospechosos, pero no podemos decir nada hasta que no se confirmen.");
 cCop.Say("En definitiva, creemos que alguien del pueblo abrió la puerta a los ladrones sobre las 4 AM. Si quieres saber más sobre el pokémon te recomiendo buscar a la sacerdotisa, aunque estos días está tan triste que se niega a hablar con nadie.");
 policia = true;
}

function cPoli_Talk()
{
 cProtag.Walk(254, 372, eBlock, eWalkableAreas);
 cProtag.FaceCharacter(cPoli);
 cPoli.Say("¿Nunca te han enseñado a no molestar a un policía? Si estuviéramos en Estados Unidos no dudaría en apuntarte con...¿Dije Estado Unidos? ¿Dónde está eso? Bueno, olvídalo.");
}

// Alcalde boss

function cAlcalde_Talk()
{
 cProtag.Walk(322, 423, eBlock, eWalkableAreas);
 cProtag.FaceCharacter(cAlcalde);
 if (primera==true) {
   cAlcalde.Say("Te he visto fisgoneando alrededor del pueblo y no me gusta nada.");
   cAlcalde.Say("Por tu actitud deduzco que has venido a incriminarme. Adelante, quiero ver qué tienes que decir. ");
   // PUZZLE 4
   dDialog7.Start();
   primera=false;
 }
 else {
  if (puzzle4== false) {
   //GAME OVER
   cSalame.Transparency = 100;
   cAlcalde.Say("Te dije que no volvieras a molestarme");
   cAlcalde.ChangeRoom(6, 72, 119);
   cProtag.ChangeRoom(6, 84, 120);
 }
}
}


// ESCENA 5

function cNino1_Talk()
{
  if (puzzle4 == true){
    dDialog13.Start();
  }
  else{
    dDialog12.Start();
  }
}
function cNino2_Talk()
{
  if (puzzle4 == true){
    dDialog13.Start();
  }
  else{
    dDialog12.Start();
  }
}
function cNino3_Talk()
{
  if (puzzle4 == true){
    dDialog13.Start();
  }
  else{
    dDialog12.Start();
  }
}

function cFuego_Interact(){
  if (puzzle4 == true){
    cFuego.Say("...");
    puntos = 1;
  }
  else{
  puntos = 0;
  }
}
function cBicho_Interact(){
  if (puntos == 1){
    puntos = 2;
    cBicho.Say("...");
  }
  else{
  puntos = 0;
  } 
}
function cPlanta_Interact(){
  if (puntos == 2){
    cPlanta.Say("...");
    cProtag.Say("!");
    RestoreWalkableArea(5); // Con esto ya puede acceder al hotspot por lo que no hay problema
  }else{
  puntos = 0;
  } 
}

function cPuertas2_Interact()
{
  cProtag.Say("No creo que me dejen pasar esos pokémon guardianes así como así. ¿Qué he de hacer? Parece que en la puerta de la cueva hay algo escrito...");
  cPuertas2.Say("Muestra tus fortalezas antes que tus debilidades - Mahatma Ghaudy");
  cProtag.Say("¿Quién es Ghaudy?");
}

// ROOM 5
function cElectrico_Talk()
{
 cProtag.Walk(329, 450, eBlock, eWalkableAreas);
 cProtag.FaceCharacter(cElectrico);
 dDialog14.Start();
 dDialog15.Start();
}

// FINAL


//EasterEgg-Diario


